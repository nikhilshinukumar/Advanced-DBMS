CREATE TABLE EMPLOYEE
(
SSN INT PRIMARY KEY,
ENAME VARCHAR(25) NOT NULL,
DESIG VARCHAR(25),
DNO INT,
DOJ DATE,
SALARY INT
);
DROP TABLE EMPLOYEE;

CREATE TABLE DEPARTMENT
(
DNUMBER INT PRIMARY KEY,
DNAME VARCHAR(25) NOT NULL,
LOC VARCHAR(25),
MGRSSN INT,
FOREIGN KEY(MGRSSN) REFERENCES EMPLOYEE(SSN)
);
DROP TABLE DEPARTMENT;

CREATE TABLE PROJECT
(
PNUMBER INT PRIMARY KEY,
PNAME VARCHAR(25) NOT NULL,
DNUM INT,
FOREIGN KEY(DNUM) REFERENCES DEPARTMENT(DNUMBER)
);
DROP TABLE PROJECT;

CREATE TABLE WORKS_IN
(
ESSN INT,
PNO INT,
HOURS INT,
FOREIGN KEY(ESSN) REFERENCES EMPLOYEE(SSN),
FOREIGN KEY(PNO) REFERENCES PROJECT(PNUMBER),
FOREIGN KEY(HOURS) REFERENCES DEPARTMENT(DNUMBER)
);
DROP TABLE WORKS_IN;

INSERT INTO DEPARTMENT(DNUMBER,DNAME,LOC)VALUES
(1,'ADMIN','CHENNAI'),
(2,'HR','BANGLORE'),
(3,'SALES','KOCHI'),
(4,'FINANCE','DELHI'),
(5,'PRODUCTION','THIRUVANTAHPURAM');
SELECT * FROM DEPARTMENT;

INSERT INTO EMPLOYEE(SSN,ENAME,DESIG,DNO,DOJ,SALARY) VALUES
(1,'ABHI','HR',2,'2009-04-12',70000),
(2,'BHAMA','ADMIN',1,'2008-03-10',75000),
(3,'CHRIZ','SALES',3,'2011-06-23',35000),
(4,'DIYA','PRODUCTION',5,'2015-08-21',32000),
(5,'GOVIND','PRODUCTION',5,'2011-10-12',35000),
(6,'HIMA','FINANCE',4,'2013-01-19',51000),
(7,'IRA','HR',2,'2010-03-15',45000),
(8,'SANDEEP','FINANCE',4,'2010-07-26',49000);
SELECT * FROM EMPLOYEE;

UPDATE DEPARTMENT SET MGRSSN=2 WHERE DNUMBER=1;
UPDATE DEPARTMENT SET MGRSSN=7 WHERE DNUMBER=2;
UPDATE DEPARTMENT SET MGRSSN=3 WHERE DNUMBER=3;
UPDATE DEPARTMENT SET MGRSSN=6 WHERE DNUMBER=4;
UPDATE DEPARTMENT SET MGRSSN=5 WHERE DNUMBER=5;
SELECT * FROM DEPARTMENT;

INSERT INTO DEPARTMENT(DNUMBER,DNAME,LOC)VALUES
(1,'ADMIN','CHENNAI'),
(2,'HR','BANGLORE'),
(3,'SALES','KOCHI'),
(4,'FINANCE','DELHI'),
(5,'PRODUCTION','THIRUVANTAHPURAM');
SELECT * FROM DEPARTMENT;

INSERT INTO PROJECT(PNUMBER,PNAME,DNUM)VALUES
(11,'BANCS TRSRY',3),
(12,'NIELESAN',5),
(13,'WORLD BNK',1),
(14,'AIRLINES',1),
(15,'AMEX',4); 
SELECT * FROM PROJECT;

INSERT INTO WORKS_IN(ESSN,PNO)VALUES
(1,14),(4,13),(8,12),(6,15),(2,11),(3,13); 
SELECT * FROM WORKS_IN;

#1
SELECT E.ENAME FROM EMPLOYEE E LEFT OUTER JOIN DEPARTMENT D ON D.DNUMBER=E.DNO WHERE E.SALARY BETWEEN 30000 AND 40000 AND D.DNUMBER=5;

#2
SELECT E.ENAME, D.DNAME FROM EMPLOYEE E LEFT OUTER JOIN DEPARTMENT D ON E.DNO=D.DNUMBER ORDER BY D.DNAME ASC, E.ENAME ASC; 

#3
SELECT P.PNUMBER, P.PNAME,COUNT(E.SSN) AS NO_EMPLOYEES FROM WORKS_IN W LEFT OUTER JOIN PROJECT P ON W.PNO=P.PNUMBER LEFT OUTER JOIN EMPLOYEE E ON W.ESSN=E.SSN GROUP BY P.PNAME, P.PNUMBER;

#4
SELECT P.PNUMBER, P.PNAME,COUNT(E.SSN) AS NO_EMPLOYEES FROM WORKS_IN W LEFT OUTER JOIN PROJECT P ON W.PNO=P.PNUMBER LEFT OUTER JOIN EMPLOYEE E ON W.ESSN=E.SSN 
GROUP BY P.PNAME, P.PNUMBER HAVING COUNT(E.SSN)>2;

#5
SELECT P.PNUMBER, P.PNAME, D.DNUMBER, COUNT(E.SSN) AS NO_EMPLOYEES FROM PROJECT P LEFT OUTER JOIN DEPARTMENT D on D.DNUMBER=P.DNUM LEFT OUTER JOIN EMPLOYEE E on E.DNO=P.DNUM 
GROUP BY P.PNAME, P.PNUMBER, D.DNUMBER HAVING D.DNUMBER=5;

#6
SELECT D.DNAME, D.DNUMBER, E.SSN, E.ENAME, E.DESIG, E.DOJ, E.SALARY FROM DEPARTMENT D, EMPLOYEE E WHERE (SELECT COUNT(*) FROM EMPLOYEE E WHERE E.DNO = D.DNUMBER AND E.SALARY> 40000)> 4
AND E.DNO=D.DNUMBER GROUP BY D.DNAME, D.DNUMBER, E.SSN, E.ENAME, E.DESIG, E.DOJ, E.SALARY;

#7
CREATE VIEW EMP_DEPT_VIEW AS SELECT * FROM EMPLOYEE NATURAL JOIN DEPARTMENT;
CALL SYS.CREATE_SYNONYM_DB('SET3.3','EMPLOYEE_DEPT_VIEW');
SELECT * FROM EMP_DEPT_VIEW;

#8 (A)
SELECT * FROM EMPLOYEE E, DEPARTMENT D WHERE E.DNO=D.DNUMBER;

#8 (B)
SELECT * FROM EMPLOYEE E, DEPARTMENT D WHERE NOT E.DNO=D.DNUMBER;

#8 (C)
SELECT * FROM EMPLOYEE E LEFT OUTER JOIN DEPARTMENT D ON E.DNO=D.DNUMBER;

#8 (D)
SELECT * FROM EMPLOYEE E RIGHT OUTER JOIN DEPARTMENT D ON E.DNO=D.DNUMBER;

#8(E)
SELECT * FROM EMPLOYEE E INNER JOIN DEPARTMENT D ON E.DNO=D.DNUMBER;












